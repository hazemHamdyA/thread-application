import{_ as q,a as B}from"./PostList-6935457d.js";import{_ as K}from"./AppDate-cb14dc0d.js";import{L as z,M as J,N as Q,O as Y,P as Z,Q as P,S as X,T as tt,U as et,_ as at,m as f,l as rt,c as N,h as v,n as l,t as y,a as A,w as O,e as H,d as $,V as st,g as nt,q as it,u as ot,K as ht,z as ct,o as m}from"./index-600bec0e.js";import{a as lt}from"./asyncDataStatues-4f9050e3.js";import"./AppFormField-d88df94d.js";var ut=z,dt=ut["__core-js_shared__"],_t=dt,x=_t,T=function(){var t=/[^.]+$/.exec(x&&x.keys&&x.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function pt(t){return!!T&&T in t}var ft=pt,vt=Function.prototype,gt=vt.toString;function yt(t){if(t!=null){try{return gt.call(t)}catch{}try{return t+""}catch{}}return""}var $t=yt,mt=J,bt=ft,Ct=Q,St=$t,wt=/[\\^$.*+?()[\]{}|]/g,It=/^\[object .+?Constructor\]$/,Ot=Function.prototype,xt=Object.prototype,Pt=Ot.toString,Dt=xt.hasOwnProperty,Nt=RegExp("^"+Pt.call(Dt).replace(wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function At(t){if(!Ct(t)||bt(t))return!1;var e=mt(t)?Nt:It;return e.test(St(t))}var Ht=At;function Tt(t,e){return t==null?void 0:t[e]}var jt=Tt,Mt=Ht,Et=jt;function Ft(t,e){var a=Et(t,e);return Mt(a)?a:void 0}var D=Ft,kt=D,Lt=kt(Object,"create"),C=Lt,j=C;function Ut(){this.__data__=j?j(null):{},this.size=0}var Rt=Ut;function zt(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Gt=zt,Vt=C,Wt="__lodash_hash_undefined__",qt=Object.prototype,Bt=qt.hasOwnProperty;function Kt(t){var e=this.__data__;if(Vt){var a=e[t];return a===Wt?void 0:a}return Bt.call(e,t)?e[t]:void 0}var Jt=Kt,Qt=C,Yt=Object.prototype,Zt=Yt.hasOwnProperty;function Xt(t){var e=this.__data__;return Qt?e[t]!==void 0:Zt.call(e,t)}var te=Xt,ee=C,ae="__lodash_hash_undefined__";function re(t,e){var a=this.__data__;return this.size+=this.has(t)?0:1,a[t]=ee&&e===void 0?ae:e,this}var se=re,ne=Rt,ie=Gt,oe=Jt,he=te,ce=se;function d(t){var e=-1,a=t==null?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}d.prototype.clear=ne;d.prototype.delete=ie;d.prototype.get=oe;d.prototype.has=he;d.prototype.set=ce;var le=d;function ue(){this.__data__=[],this.size=0}var de=ue,_e=Y;function pe(t,e){for(var a=t.length;a--;)if(_e(t[a][0],e))return a;return-1}var S=pe,fe=S,ve=Array.prototype,ge=ve.splice;function ye(t){var e=this.__data__,a=fe(e,t);if(a<0)return!1;var r=e.length-1;return a==r?e.pop():ge.call(e,a,1),--this.size,!0}var $e=ye,me=S;function be(t){var e=this.__data__,a=me(e,t);return a<0?void 0:e[a][1]}var Ce=be,Se=S;function we(t){return Se(this.__data__,t)>-1}var Ie=we,Oe=S;function xe(t,e){var a=this.__data__,r=Oe(a,t);return r<0?(++this.size,a.push([t,e])):a[r][1]=e,this}var Pe=xe,De=de,Ne=$e,Ae=Ce,He=Ie,Te=Pe;function _(t){var e=-1,a=t==null?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}_.prototype.clear=De;_.prototype.delete=Ne;_.prototype.get=Ae;_.prototype.has=He;_.prototype.set=Te;var je=_,Me=D,Ee=z,Fe=Me(Ee,"Map"),ke=Fe,M=le,Le=je,Ue=ke;function Re(){this.size=0,this.__data__={hash:new M,map:new(Ue||Le),string:new M}}var ze=Re;function Ge(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var Ve=Ge,We=Ve;function qe(t,e){var a=t.__data__;return We(e)?a[typeof e=="string"?"string":"hash"]:a.map}var w=qe,Be=w;function Ke(t){var e=Be(this,t).delete(t);return this.size-=e?1:0,e}var Je=Ke,Qe=w;function Ye(t){return Qe(this,t).get(t)}var Ze=Ye,Xe=w;function ta(t){return Xe(this,t).has(t)}var ea=ta,aa=w;function ra(t,e){var a=aa(this,t),r=a.size;return a.set(t,e),this.size+=a.size==r?0:1,this}var sa=ra,na=ze,ia=Je,oa=Ze,ha=ea,ca=sa;function p(t){var e=-1,a=t==null?0:t.length;for(this.clear();++e<a;){var r=t[e];this.set(r[0],r[1])}}p.prototype.clear=na;p.prototype.delete=ia;p.prototype.get=oa;p.prototype.has=ha;p.prototype.set=ca;var la=p,ua="__lodash_hash_undefined__";function da(t){return this.__data__.set(t,ua),this}var _a=da;function pa(t){return this.__data__.has(t)}var fa=pa,va=la,ga=_a,ya=fa;function b(t){var e=-1,a=t==null?0:t.length;for(this.__data__=new va;++e<a;)this.add(t[e])}b.prototype.add=b.prototype.push=ga;b.prototype.has=ya;var $a=b;function ma(t,e,a,r){for(var s=t.length,n=a+(r?1:-1);r?n--:++n<s;)if(e(t[n],n,t))return n;return-1}var ba=ma;function Ca(t){return t!==t}var Sa=Ca;function wa(t,e,a){for(var r=a-1,s=t.length;++r<s;)if(t[r]===e)return r;return-1}var Ia=wa,Oa=ba,xa=Sa,Pa=Ia;function Da(t,e,a){return e===e?Pa(t,e,a):Oa(t,xa,a)}var Na=Da,Aa=Na;function Ha(t,e){var a=t==null?0:t.length;return!!a&&Aa(t,e,0)>-1}var Ta=Ha;function ja(t,e,a){for(var r=-1,s=t==null?0:t.length;++r<s;)if(a(e,t[r]))return!0;return!1}var Ma=ja;function Ea(t,e){for(var a=-1,r=t==null?0:t.length,s=Array(r);++a<r;)s[a]=e(t[a],a,t);return s}var Fa=Ea;function ka(t){return function(e){return t(e)}}var La=ka;function Ua(t,e){return t.has(e)}var Ra=Ua,za=$a,Ga=Ta,Va=Ma,Wa=Fa,qa=La,Ba=Ra,Ka=200;function Ja(t,e,a,r){var s=-1,n=Ga,o=!0,i=t.length,u=[],I=e.length;if(!i)return u;a&&(e=Wa(e,qa(a))),r?(n=Va,o=!1):e.length>=Ka&&(n=Ba,o=!1,e=new za(e));t:for(;++s<i;){var h=t[s],c=a==null?h:a(h);if(h=r||h!==0?h:0,o&&c===c){for(var g=I;g--;)if(e[g]===c)continue t;u.push(h)}else n(e,c,r)||u.push(h)}return u}var Qa=Ja;function Ya(t,e){for(var a=-1,r=e.length,s=t.length;++a<r;)t[s+a]=e[a];return t}var Za=Ya,Xa=Z,tr=P,er="[object Arguments]";function ar(t){return tr(t)&&Xa(t)==er}var rr=ar,E=rr,sr=P,G=Object.prototype,nr=G.hasOwnProperty,ir=G.propertyIsEnumerable,or=E(function(){return arguments}())?E:function(t){return sr(t)&&nr.call(t,"callee")&&!ir.call(t,"callee")},hr=or,cr=Array.isArray,lr=cr,F=X,ur=hr,dr=lr,k=F?F.isConcatSpreadable:void 0;function _r(t){return dr(t)||ur(t)||!!(k&&t&&t[k])}var pr=_r,fr=Za,vr=pr;function V(t,e,a,r,s){var n=-1,o=t.length;for(a||(a=vr),s||(s=[]);++n<o;){var i=t[n];e>0&&a(i)?e>1?V(i,e-1,a,r,s):fr(s,i):r||(s[s.length]=i)}return s}var gr=V;function yr(t){return t}var W=yr;function $r(t,e,a){switch(a.length){case 0:return t.call(e);case 1:return t.call(e,a[0]);case 2:return t.call(e,a[0],a[1]);case 3:return t.call(e,a[0],a[1],a[2])}return t.apply(e,a)}var mr=$r,br=mr,L=Math.max;function Cr(t,e,a){return e=L(e===void 0?t.length-1:e,0),function(){for(var r=arguments,s=-1,n=L(r.length-e,0),o=Array(n);++s<n;)o[s]=r[e+s];s=-1;for(var i=Array(e+1);++s<e;)i[s]=r[s];return i[e]=a(o),br(t,this,i)}}var Sr=Cr;function wr(t){return function(){return t}}var Ir=wr,Or=D,xr=function(){try{var t=Or(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Pr=xr,Dr=Ir,U=Pr,Nr=W,Ar=U?function(t,e){return U(t,"toString",{configurable:!0,enumerable:!1,value:Dr(e),writable:!0})}:Nr,Hr=Ar,Tr=800,jr=16,Mr=Date.now;function Er(t){var e=0,a=0;return function(){var r=Mr(),s=jr-(r-a);if(a=r,s>0){if(++e>=Tr)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Fr=Er,kr=Hr,Lr=Fr,Ur=Lr(kr),Rr=Ur,zr=W,Gr=Sr,Vr=Rr;function Wr(t,e){return Vr(Gr(t,e,zr),t+"")}var qr=Wr,Br=tt,Kr=P;function Jr(t){return Kr(t)&&Br(t)}var Qr=Jr,Yr=Qa,Zr=gr,Xr=qr,R=Qr,ts=Xr(function(t,e){return R(t)?Yr(t,Zr(e,1,R,!0)):[]}),es=ts;const as=et(es),rs={props:["id"],emits:["ready"],data:()=>({}),setup(){const{addNotification:t}=st();return{addNotification:t}},mixins:[lt],computed:{...f(nt),...f(it),...f(ot),...f(ht),...f(ct),authUser(){return this.authStore.authUser},threads(){return this.threadsStore.items},posts(){return this.postsStore.items},thread(){return this.threadsStore.thread(this.id)},threadPosts(){var e;return(e=this.posts)==null?void 0:e.filter(a=>a.threadId===this.id)}},methods:{addPost(t){const e={...t,threadId:this.id};this.postsStore.addPost(e),this.postsStore.appendPostToThread({threadId:e.threadId,id:e.id})},async featchPostsWithUsers(t){const a=await(await this.postsStore.featchPosts(t,!1,({islocal:r})=>{!this.asyncDataStatues_isReady||r||this.addNotification({message:"thread recently updated",timeout:3e3})})).map(r=>r.userId).concat(this.thread.userId);await this.usersStore.featchUsers(a)}},async created(){const t=await this.threadsStore.featchThread(this.id,!1,async({islocal:e,item:a,previousItem:r})=>{if(!this.asyncDataStatues_isReady||e)return;const s=as(a.posts,r.posts);s.length>0?await this.featchPostsWithUsers(s):this.addNotification({message:"thread recently updated",timeout:3e3})});await this.featchPostsWithUsers(t.posts),this.asyncDataStatues_featched()}},ss={key:0,class:"col-large push-top"},ns=["onClick"],is={href:"#",class:"link-unstyled"},os={style:{float:"right","margin-top":"2px"},class:"hide-mobile text-faded text-small"},hs={key:1,class:"text-center",style:{"margin-bottom":"50px"}};function cs(t,e,a,r,s,n){var h,c;const o=rt("router-link"),i=K,u=q,I=B;return t.asyncDataStatues_isReady?(m(),N("div",ss,[v("h1",null,[l(y(n.thread.title)+" ",1),n.thread.userId==((h=n.authUser)==null?void 0:h.id)?(m(),A(o,{key:0,to:{name:"threadEdit",params:{id:this.id}},custom:""},{default:O(({navigate:g})=>[v("button",{onClick:g,class:"btn-green btn-small"},"Edit Thread",8,ns)]),_:1},8,["to"])):H("",!0)]),v("p",null,[l(" By "),v("a",is,y((c=n.thread.author)==null?void 0:c.name),1),l(", "),$(i,{"time-change":n.thread.publishedAt},null,8,["time-change"]),v("span",os,y(n.thread.replaiesCount)+" replies by "+y(n.thread.contributorsCount)+" contributors",1)]),$(u,{posts:n.threadPosts},null,8,["posts"]),n.authUser?(m(),A(I,{key:0,onSave:n.addPost},null,8,["onSave"])):(m(),N("div",hs,[$(o,{to:{name:"login",query:{redirectTo:t.$route.path}}},{default:O(()=>[l("Login")]),_:1},8,["to"]),l(" or "),$(o,{to:{name:"register",query:{redirectTo:t.$route.path}}},{default:O(()=>[l("Register")]),_:1},8,["to"]),l(" to can replay on thread ")]))])):H("",!0)}const fs=at(rs,[["render",cs]]);export{fs as default};
